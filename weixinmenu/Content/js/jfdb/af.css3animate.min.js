define(function(require){var a=require("$");(function(h){var c=[];var d=function(l){if(!l.afCSS3AnimateId){l.afCSS3AnimateId=h.uuid();}return l.afCSS3AnimateId;};var f=function(l){if(typeof l==="string"||l instanceof String){return document.getElementById(l);
}else{if(h.is$(l)){return l[0];}else{return l;}}};var k=function(o,l){var m,p,n=f(o);p=d(n);if(c[p]){c[p].animate(l);m=c[p];}else{m=i(n,l);c[p]=m;}return m;
};h.fn.css3Animate=function(n){if(!n.complete&&n.callback){n.complete=n.callback;}var m=k(this[0],n);n.complete=null;n.sucess=null;n.failure=null;for(var l=1;
l<this.length;l++){m.link(this[l],n);}return m;};h.css3AnimateQueue=function(){return new i.queue();};var j=h.feat.cssTransformStart;var g=h.feat.cssTransformEnd;
var e=h.feat.cssPrefix.replace(/-/g,"")+"TransitionEnd";e=(h.os.fennec||h.feat.cssPrefix===""||h.os.ie)?"transitionend":e;e=e.replace(e.charAt(0),e.charAt(0).toLowerCase());
var i=(function(){var l=function(m,n){if(!(this instanceof l)){return new l(m,n);}this.callbacksStack=[];this.activeEvent=null;this.countStack=0;this.isActive=false;
this.el=m;this.linkFinishedProxy=h.proxy(this.linkFinished,this);if(!this.el){return;}this.animate(n);var o=this;a(this.el).bind("destroy",function(){var p=o.el.afCSS3AnimateId;
o.callbacksStack=[];if(c[p]){delete c[p];}});};l.prototype={animate:function(w){if(this.isActive){this.cancel();}this.isActive=true;if(!w){window.alert("Please provide configuration options for animation of "+this.el.id);
return;}var n=!!w.addClass;var p,o;var u=numOnly(w.time);if(n){if(w.removeClass){a(this.el).replaceClass(w.removeClass,w.addClass);}else{a(this.el).addClass(w.addClass);
}}else{if(u===0){w.time=0;}if(!w.y){w.y=0;}if(!w.x){w.x=0;}if(w.previous){var r=new h.getCssMatrix(this.el);w.y+=numOnly(r.f);w.x+=numOnly(r.e);}if(!w.origin){w.origin="0% 0%";
}if(!w.scale){w.scale="1";}if(!w.rotateY){w.rotateY="0";}if(!w.rotateX){w.rotateX="0";}if(!w.skewY){w.skewY="0";}if(!w.skewX){w.skewX="0";}if(!w.timingFunction){w.timingFunction="linear";
}if(typeof(w.x)==="number"||(w.x.indexOf("%")===-1&&w.x.toLowerCase().indexOf("px")===-1&&w.x.toLowerCase().indexOf("deg")===-1)){w.x=parseInt(w.x,10)+"px";
}if(typeof(w.y)==="number"||(w.y.indexOf("%")===-1&&w.y.toLowerCase().indexOf("px")===-1&&w.y.toLowerCase().indexOf("deg")===-1)){w.y=parseInt(w.y,10)+"px";
}var v="translate"+j+(w.x)+","+(w.y)+g+" scale("+parseFloat(w.scale)+") rotate("+w.rotateX+")";if(!h.os.opera){v+=" rotateY("+w.rotateY+")";}v+=" skew("+w.skewX+","+w.skewY+")";
this.el.style[h.feat.cssPrefix+"Transform"]=v;this.el.style[h.feat.cssPrefix+"BackfaceVisibility"]="hidden";var t=h.feat.cssPrefix+"Transform";if(w.opacity!==undefined){this.el.style.opacity=w.opacity;
t+=", opacity";}if(w.width){this.el.style.width=w.width;t="all";}if(w.height){this.el.style.height=w.height;t="all";}this.el.style[h.feat.cssPrefix+"TransitionProperty"]="all";
if((""+w.time).indexOf("s")===-1){p="ms";o=w.time+p;}else{if(w.time.indexOf("ms")!==-1){p="ms";o=w.time;}else{p="s";o=w.time+p;}}if(w.delay){this.el.style[h.feat.cssPrefix+"TransitionDelay"]=w.delay;
}this.el.style[h.feat.cssPrefix+"TransitionDuration"]=o;this.el.style[h.feat.cssPrefix+"TransitionTimingFunction"]=w.timingFunction;this.el.style[h.feat.cssPrefix+"TransformOrigin"]=w.origin;
}this.callbacksStack.push({complete:w.complete,success:w.success,failure:w.failure});this.countStack++;var s=this,q;var m=window.getComputedStyle(this.el);
if(n){q=m[h.feat.cssPrefix+"TransitionDuration"];u=numOnly(q);w.time=u;if(q.indexOf("ms")!==-1){p="ms";}else{p="s";w.time*=1000;}}if(u===0||(p==="ms"&&u<5)||m.display==="none"){h.asap(h.proxy(this.finishAnimation,this,[false]));
}else{this.activeEvent=function(x){clearTimeout(s.timeout);s.finishAnimation(x);s.el.removeEventListener(e,s.activeEvent,false);};s.timeout=setTimeout(this.activeEvent,numOnly(w.time)+50);
this.el.addEventListener(e,this.activeEvent,false);}},addCallbackHook:function(m){if(m){this.callbacksStack.push(m);}this.countStack++;return this.linkFinishedProxy;
},linkFinished:function(m){if(m){this.cancel();}else{this.finishAnimation();}},finishAnimation:function(m){if(m&&m.preventDefault){m.preventDefault();}if(!this.isActive){return;
}this.countStack--;if(this.countStack===0){this.fireCallbacks(false);}},fireCallbacks:function(m){this.clearEvents();var q=this.callbacksStack;this.cleanup();
for(var p=0;p<q.length;p++){var n=q[p].complete;var r=q[p].success;var o=q[p].failure;if(typeof(n)==="function"){n(m);}if(m&&typeof(o)==="function"){o();
}else{if(typeof(r)==="function"){r();}}}},cancel:function(){if(!this.isActive){return;}this.fireCallbacks(true);},cleanup:function(){this.callbacksStack=[];
this.isActive=false;this.countStack=0;},clearEvents:function(){if(this.activeEvent){this.el.removeEventListener(e,this.activeEvent,false);}this.activeEvent=null;
},link:function(m,o){var n={complete:o.complete,success:o.success,failure:o.failure};o.complete=this.addCallbackHook(n);o.success=null;o.failure=null;k(m,o);
o.complete=n.complete;o.success=n.success;o.failure=n.failure;return this;}};return l;})();i.queue=function(){return{elements:[],push:function(l){this.elements.push(l);
},pop:function(){return this.elements.pop();},run:function(){var m=this;if(this.elements.length===0){return;}if(typeof(this.elements[0])==="function"){var l=this.shift();
l();}if(this.elements.length===0){return;}var n=this.shift();if(this.elements.length>0){n.complete=function(o){if(!o){m.run();}};}i(document.getElementById(n.id),n);
},shift:function(){return this.elements.shift();}};};})(a);if(!Date.now){Date.now=function(){return new Date().getTime();};}(function(){var f=["webkit","moz","ms"];
for(var d=0;d<f.length&&!window.requestAnimationFrame;++d){var c=f[d];window.requestAnimationFrame=window[c+"RequestAnimationFrame"];window.cancelAnimationFrame=(window[c+"CancelAnimationFrame"]||window[c+"CancelRequestAnimationFrame"]);
}if(/iP(ad|hone|od).*OS 6/.test(window.navigator.userAgent)||!window.requestAnimationFrame||!window.cancelAnimationFrame){var e=0;window.requestAnimationFrame=function(i){var h=Date.now();
var g=Math.max(e+16,h);return setTimeout(function(){i(e=g);},g-h);};window.cancelAnimationFrame=clearTimeout;}}());(function(h){var e=[];var f=function(j){if(!j.afAnimateId){j.afAnimateId=h.uuid();
}return j.afAnimateId;};var d=function(j){if(typeof j==="string"||j instanceof String){return document.getElementById(j);}else{if(h.is$(j)){return j[0];
}else{return j;}}};var g=function(m,j){var k,n,l=d(m);n=f(l);if(e[n]){if(j){e[n].animate(j);}k=e[n];}else{k=c(l,j);e[n]=k;}return k;};h.fn.animate=function(k){var j=g(this[0],k);
return j;};var c=function(j,k){if(!(this instanceof c)){return new c(j,k);}this.el=j;if(!this.el){return;}if(k){this.animate(k);}var l=this;a(this.el).bind("destroy",function(){var m=l.el.afAnimateId;
if(e[m]){delete e[m];}});};c.prototype={animationTimer:null,isAnimating:false,startX:0,startY:0,runTime:0,endX:0,endY:0,currX:0,currY:0,animationStartTime:0,pauseTime:0,completeCB:null,easingFn:"linear",animateOpts:{},updateCb:null,animate:function(j){var k=this;
if(k.isAnimating){return;}k.isAnimating=true;window.cancelAnimationFrame(k.animationTimer);if(!j){j={x:0,y:0,duration:0};}this.easingFn=j.easing||"linear";
this.completeCB=j.complete||null;this.updateCB=j.update||null;this.runTime=numOnly(j.duration);j.complete&&(delete j.complete);this.animateOpts=j;this.startTime=Date.now();
this.startMatrix=h.getCssMatrix(this.el);if(this.runTime===0){this.doAnimate();}},start:function(){this.doAnimate();},doAnimate:function(){var j=Date.now(),n,m,l,k=this;
if(this.runTime===0||(j>=this.startTime+this.runTime)){k.setPosition(this.animateOpts.x,this.animateOpts.y);k.isAnimating=false;if(this.updateCB){this.updateCB({x:this.animateOpts.x,y:this.animateOpts.y});
}if(this.completeCB){this.completeCB();}return;}j=(j-this.startTime)/this.runTime;j=j>1?1:j;l=i[this.easingFn](j);n=(this.animateOpts.x-this.startMatrix.e)*l+this.startMatrix.e;
m=(this.animateOpts.y-this.startMatrix.f)*l+this.startMatrix.f;this.setPosition(n,m);if(this.updateCB){this.updateCB({x:n,y:m});}if(this.isAnimating){this.animationTimer=window.requestAnimationFrame(function(){k.doAnimate();
});}},setPosition:function(j,k){this.el.style[h.feat.cssPrefix+"Transform"]="matrix3d( 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 0, "+j+", "+k+", 0, 1 )";this.currX=j;
this.currY=k;},stop:function(){this.isAnimating=false;window.cancelAnimationFrame(this.animationTimer);this.pauseTime=Date.now()-this.startTime;},resume:function(){this.isAnimating=true;
this.startTime=Date.now()-this.pauseTime;this.doAnimate();}};var i={linear:function(j){return j;},easeOutSine:function(j){return Math.sin(j*Math.PI/2);
}};})(a);});